--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _fnYewI7FEeWetPU-dn-gxQ
Element-Name: QuickFixForWrongResourcePath
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _hmnS8I7CEeWetPU-dn-gxQ
Runtime-Version: 2.1.0.201606221726
Save-Time: 12/14/16 12:13 PM
Testcase-Type: ecl
Verifications: _qtiWAI7UEeWetPU-dn-gxQ

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

proc "wait-for-problems" [val count]{
	try -times 4 -delay 1000 -command{
		get-view Problems | get-tree | get-item "Errors? \\(.* items?\\)" | get-property childCount | equals $count | verify-true
	}	
}
proc "open-quick-fix" [val errorText]{
	try -times 3 -delay 1000 -command{
		get-view Problems | get-tree | select $errorText | get-menu "Quick Fix" | click
	}
}
//-----------------------------------------------------------------------------------------------------------

get-view "Project Explorer" | get-tree | select "MediumRobotTest/TestFile.robot" | double-click

with [get-tab-folder -index 4] {
    get-tab-item Problems | click
}
wait-for-problems -count 11
//check if are all errors
with [get-view Problems | get-tree] {
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[0].getText()" 
        | equals "Resource import '../../../../../../SecondProject/abc.tsv' is invalid: file does not exist" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[0].getData().getLocation()" | equals "line 16" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[0].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[1].getText()" 
        | equals "Resource import '../SecondProject2/res2/res.robot' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[1].getData().getLocation()" | equals "line 6" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[1].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[2].getText()" 
        | equals "Resource import '../text_file.txt' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[2].getData().getLocation()" | equals "line 10" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[2].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[3].getText()" 
        | equals "Resource import '/../../../../SecondProject/res1/res3/RES.ROBOT' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[3].getData().getLocation()" | equals "line 7" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[3].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
        
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[4].getText()" 
        | equals "Resource import '/ala/has/a/cat.txt' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[4].getData().getLocation()" | equals "line 17" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[4].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
        
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[5].getText()" 
        | equals "Resource import 'abc.tsv' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[5].getData().getLocation()" | equals "line 15" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[5].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[6].getText()" 
        | equals "Resource import 'Capture.JPG' is invalid: given file is not a Resource file" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[6].getData().getLocation()" | equals "line 11" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[6].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[7].getText()" 
        | equals "Resource import 'deep.resource' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[7].getData().getLocation()" | equals "line 13" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[7].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[8].getText()" 
        | equals "Resource import 'res1/deep_res.robot' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[8].getData().getLocation()" | equals "line 14" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[8].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[9].getText()" 
        | equals "Resource import 'res1/res3/../../simple_res.robot' is invalid: file does not exist" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[9].getData().getLocation()" | equals "line 3" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[9].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[10].getText()" 
        | equals "Resource import 'var1.py' is invalid: file does not exist. Check file name and path." | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[10].getData().getLocation()" | equals "line 20" 
        | verify-true
    get-item "Errors \\(11 items\\)" | get-property "getItems().TreeItem[10].getData().getPath()" 
        | equals "/MediumRobotTest" | verify-true
}

//check warnings
with [get-view Problems | get-tree] {
    get-item "Warnings \\(3 items\\)" | get-property childCount | equals 3 | verify-true
    get-item "Warnings \\(3 items\\)" | get-property "getItems().TreeItem[0].getText()" 
        | equals "Path '/../../../../SecondProject/res1/res3/RES.ROBOT' is absolute. It is preferred to use relative paths" 
        | verify-true
    get-item "Warnings \\(3 items\\)" | get-property "getItems().TreeItem[1].getText()" 
        | equals "Path '/ala/has/a/cat.txt' is absolute. It is preferred to use relative paths" | verify-true
    get-item "Warnings \\(3 items\\)" | get-property "getItems().TreeItem[2].getText()" 
        | equals "The keyword 'kw duplicate' is masking the keyword 'kw duplicate' defined in res. Use 'res.kw duplicate' in this suite file if the latter is desired" 
        | verify-true
    get-item "Warnings \\(3 items\\)" | get-property "getText()" | equals "Warnings (3 items)" | verify-true
}


//check that 2 Problems has no Quick fix
try -times 3 -delay 1000 -command{
	get-view Problems | get-tree | select "Errors (11 items)/Resource import 'Capture.JPG' is invalid: given file is not a Resource file"
	get-view Problems | get-tree | get-menu "Quick Fix" | get-property enablement | equals false | verify-true
	get-view Problems | get-tree | select "Errors (11 items)/Resource import 'var1.py' is invalid: file does not exist. Check file name and path."
	get-view Problems | get-tree | get-menu "Quick Fix" | get-property enablement | equals false | verify-true
}	

//-----------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (11 items)/Resource import '..\\/SecondProject2\\/res2\\/res.robot' is invalid: file does not exist"

get-window "Quick Fix" | get-table | select "Change to \\/SecondProject\\/res2\\/res.robot"
with [get-window "Quick Fix"] {
    with [get-table] {
        get-property itemCount | equals 5 | verify-true
        get-property "getItems().TableItem[0].getText()" | equals "Change to /MediumRobotTest/res1/res.robot" 
            | verify-true
        get-property "getItems().TableItem[1].getText()" | equals "Change to /MediumRobotTest/res1/res3/res.robot" 
            | verify-true
        get-property "getItems().TableItem[2].getText()" | equals "Change to /MediumRobotTest/res2/res.robot" 
            | verify-true
        get-property "getItems().TableItem[3].getText()" | equals "Change to /SecondProject/res1/res.robot" 
            | verify-true
        get-property "getItems().TableItem[4].getText()" | equals "Change to /SecondProject/res2/res.robot" 
            | verify-true
    }
    with [get-table -after [get-label "Problems:"]] {
        get-property itemCount | equals 1 | verify-true
        get-item "TestFile.robot" | get-property "values['Location']" | equals "line 6" | verify-true
        get-item "TestFile.robot" | get-property "values['Resource']" | equals "TestFile.robot" | verify-true
    }
}
get-window "Quick Fix" | get-button Finish | click

wait-for-problems -count 10

//-----------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (10 items)/Resource import '..\\/text_file.txt' is invalid: file does not exist"

with [get-window "Quick Fix"] {
    with [get-table] {
        get-property itemCount | equals 1 | verify-true
        get-property "getItems().TableItem[0].getText()" | equals "Change to /MediumRobotTest/text_file.txt" 
            | verify-true
    }
    with [get-table -after [get-label "Problems:"]] {
        get-property itemCount | equals 1 | verify-true
        get-item "TestFile.robot" | get-property "values['Location']" | equals "line 10" | verify-true
        get-item "TestFile.robot" | get-property "values['Resource']" | equals "TestFile.robot" | verify-true
    }
}
get-window "Quick Fix" | get-button Finish | click

wait-for-problems -count 9

//-----------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (9 items)/Resource import 'abc.tsv' is invalid: file does not exist"

with [get-window "Quick Fix"] {
    with [get-table] {
        get-property itemCount | equals 1 | verify-true
        get-property "getItems().TableItem[0].getText()" | equals "Change to /SecondProject/abc.tsv" | verify-true
    }
    with [get-table -after [get-label "Problems:"]] {
        get-property itemCount | equals 1 | verify-true
        get-item "TestFile.robot" | get-property "values['Location']" | equals "line 15" | verify-true
        get-item "TestFile.robot" | get-property "values['Resource']" | equals "TestFile.robot" | verify-true
    }
}
get-window "Quick Fix" | get-button Finish | click

wait-for-problems -count 8

//-----------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (8 items)/Resource import 'res1\\/deep_res.robot' is invalid: file does not exist"

with [get-window "Quick Fix"] {
    with [get-table] {
        get-property itemCount | equals 1 | verify-true
        get-property "getItems().TableItem[0].getText()" | equals "Change to /MediumRobotTest/res1/res3/deep_res.robot" 
            | verify-true
    }
    with [get-table -after [get-label "Problems:"]] {
        get-property itemCount | equals 1 | verify-true
        get-item "TestFile.robot" | get-property "values['Location']" | equals "line 14" | verify-true
        get-item "TestFile.robot" | get-property "values['Resource']" | equals "TestFile.robot" | verify-true
    }
}
get-window "Quick Fix" | get-button Finish | click

wait-for-problems -count 7

//---------------------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (7 items)/Resource import 'deep.resource' is invalid: file does not exist"

try -times 3 -delay 1000 -command{
	get-window "Quick Fix" 
	    | get-label "No fixes available for 'Resource import 'deep.resource' is invalid: file does not exist'." 
	    | get-property caption 
	    | equals "No fixes available for 'Resource import 'deep.resource' is invalid: file does not exist'." | verify-true
}
get-window "Quick Fix" | get-button OK | click

open-quick-fix -errorText "Errors (7 items)/Resource import 'res1\\/res3\\/..\\/..\\/simple_res.robot' is invalid: file does not exist"

with [get-window "Quick Fix"] {
    with [get-table] {
        get-property itemCount | equals 1 | verify-true
        get-property "getItems().TableItem[0].getText()" | equals "Change to /MediumRobotTest/res1/simple_res.robot" 
            | verify-true
    }
    with [get-table -after [get-label "Problems:"]] {
        get-property itemCount | equals 1 | verify-true
        get-item "TestFile.robot" | get-property "values['Location']" | equals "line 3" | verify-true
        get-item "TestFile.robot" | get-property "values['Resource']" | equals "TestFile.robot" | verify-true
    }
}
get-window "Quick Fix" | get-button Finish | click

wait-for-problems -count 6
wait 1000
//-----------------------------------------------------------------------------------------------------------
open-quick-fix -errorText "Errors (6 items)/Resource import 'deep.resource' is invalid: file does not exist"

get-window "Quick Fix" 
    | get-label "No fixes available for 'Resource import 'deep.resource' is invalid: file does not exist'." 
    | get-property caption 
    | equals "No fixes available for 'Resource import 'deep.resource' is invalid: file does not exist'." | verify-true

get-window "Quick Fix" | get-button OK | click


------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
